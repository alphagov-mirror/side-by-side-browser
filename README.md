# Side-by-side browser

Proxy a web site to preview redirections ahead of it being transitioned to GOV.UK.

[![sketchy explanation](http://farm3.staticflickr.com/2831/12187616853_d4b6008b5f_z.jpg "sketchy explanation")](http://www.flickr.com/photos/psd/12187616853)

## Run the tests

    $ npm install
    $ npm test

## Development

    $ node server.js

...then you can use [xip.io](http://xip.io/) to make it work with localhost, eg:

http://www.environment-agency.gov.uk.side-by-side.127.0.0.1.xip.io:3023/__/#/

## Installation

Run the server using an init.d script, such as those generated by [initd-forever](https://npmjs.org/package/initd-forever):

    $ npm install -g forever initd-forever
    $ initd-forever -a /data/side-by-side-browser/server.js -n side-by-side -l /var/log/side-by-side

You must set the `SIDE_BY_SIDE_HOME` environment variable to the location of the app (`/data/side-by-side-browser/`).  This needs to be done in this init.d script manually.  `initd-forever` has an `-e` option, but that only allows setting the `NODE_ENV` variable, not other environment variables.  To do this add an:

    export SIDE_BY_SIDE_HOME=/data/side-by-side-browser/

line in the `start()` function before the `forever` script invokes the app.

You can then make the script executable and move it into `/etc/init.d`:

    $ chmod +x side-by-side ; mv side-by-side /etc/init.d

You can use nginx to proxy the server onto port 80:

    $ cp etc/side-by-side.conf /etc/nginx/sites-available
    $ ln -s /etc/nginx/sites-available/side-by-side.conf /etc/nginx/sites-enabled
